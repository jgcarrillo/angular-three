"use strict";(self.webpackChunksandbox=self.webpackChunksandbox||[]).push([[777],{4092:(z,y,o)=>{o.r(y),o.d(y,{HeightFieldExampleComponent:()=>Z,HeightFieldExampleComponentModule:()=>lt});var p=o(2806),d=o(7017),m=o(280),S=o(8649),F=o(1412),M=o(258),a=o(2610),f=o(1873),x=o(3845),C=o(8427),O=o(6608),A=o(5e3),t=o(1858),Q=o(752),E=o(1845),J=o(1487),H=o(6963);const T=["elementSize","","heights",""],G=["*"];let N=(()=>{class e extends S.DE{constructor(){super(...arguments),this.elementSize=0}set heights(n){this.set({heights:n})}ngOnInit(){super.ngOnInit(),this.zone.runOutsideAngular(()=>{this.onCanvasReady(this.store.ready$,()=>{this.effect((0,J.b)(()=>{if(!this.instanceValue)return;const n=this.get(r=>r.heights),s=this.elementSize,l=this.elementSize,v=n.flatMap((r,c)=>r.flatMap((u,h)=>[c*s,h*l,u])),g=[];for(let r=0;r<n.length-1;r++)for(let c=0;c<n[r].length-1;c++){const u=n[r].length,h=r*u+c;g.push(h+1,h+u,h+u+1),g.push(h+u,h+1,h)}this.instanceValue.setIndex(g),this.instanceValue.setAttribute("position",new H.a$l(v,3)),this.instanceValue.computeVertexNormals(),this.instanceValue.computeBoundingBox(),this.instanceValue.computeBoundingSphere()}))(this.select(this.instance$,this.select(n=>n.heights)))})})}}return e.\u0275fac=function(){let i;return function(s){return(i||(i=t.n5z(e)))(s||e)}}(),e.\u0275cmp=t.Xpm({type:e,selectors:[["sandbox-height-field-geometry","elementSize","","heights",""]],inputs:{elementSize:"elementSize",heights:"heights"},features:[t._Bn([(0,d.O2)(e)]),t.qOj],attrs:T,ngContentSelectors:G,decls:1,vars:0,template:function(n,s){1&n&&(t.F$t(),t.Hsn(0))},encapsulation:2,changeDetection:0}),e})();const P=["elementSize","","heights","","position","","rotation",""];let U=(()=>{class e{constructor(n){this.physicBody=n,this.elementSize=0,this.heights=[],this.position=[0,0,0],this.rotation=[0,0,0],this.color=A[17][4],this.heightFieldRef=this.physicBody.useHeightfield(()=>({args:[this.heights,{elementSize:this.elementSize}],position:this.position,rotation:this.rotation}))}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(p.CN))},e.\u0275cmp=t.Xpm({type:e,selectors:[["sandbox-height-field","elementSize","","heights","","position","","rotation",""]],inputs:{elementSize:"elementSize",heights:"heights",position:"position",rotation:"rotation"},features:[t._Bn([p.CN])],attrs:P,decls:3,vars:4,consts:[["castShadow","","receiveShadow","",3,"ref"],[3,"color"],[3,"elementSize","heights"]],template:function(n,s){1&n&&(t.TgZ(0,"ngt-mesh",0),t._UZ(1,"ngt-mesh-phong-material",1)(2,"sandbox-height-field-geometry",2),t.qZA()),2&n&&(t.Q6J("ref",s.heightFieldRef.ref),t.xp6(1),t.Q6J("color",s.color),t.xp6(1),t.Q6J("elementSize",s.elementSize)("heights",s.heights))},directives:[Q.o,E.l,N],encapsulation:2,changeDetection:0}),e})();var V=o(2363),L=o(1747),R=o(8730);const j=["columns","","rows","","spread",""],$=function(){return[.2,16,16]},K=function(){return["attributes","color"]},X=function(e){return[e,3]};function W(e,i){if(1&e&&(t.ynx(0),t.TgZ(1,"ngt-instanced-mesh",1)(2,"ngt-sphere-geometry",2),t._UZ(3,"ngt-instanced-buffer-attribute",3),t.qZA(),t._UZ(4,"ngt-mesh-phong-material",4),t.qZA(),t.BQk()),2&e){const n=i.ngIf,s=t.oxw();t.xp6(1),t.Q6J("count",n.number)("ref",s.sphereRef.ref),t.xp6(1),t.Q6J("args",t.DdM(5,$)),t.xp6(1),t.Q6J("attach",t.DdM(6,K))("args",t.VKq(7,X,n.colors))}}let Y=(()=>{class e extends d.gU{constructor(n){super(),this.physicBody=n,this.spread=0,this.sphereRef=this.physicBody.useSphere(s=>({args:[.2],mass:1,position:[(s%this.get(l=>l.columns)-(this.get(l=>l.columns)-1)/2)*this.spread,2,(Math.floor(s/this.get(l=>l.columns))-(this.get(l=>l.rows)-1)/2)*this.spread]})),this.viewModel$=this.select(this.select(s=>s.columns),this.select(s=>s.rows),(s,l)=>{const v=s*l,g=new Float32Array(3*v),r=new H.Ilk;for(let c=0;c<v;c++)r.set(A[17][Math.floor(5*Math.random())]).convertSRGBToLinear().toArray(g,3*c);return{colors:g,number:v}})}set columns(n){this.set({columns:(0,d.su)(n)})}set rows(n){this.set({rows:(0,d.su)(n)})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(p.CN))},e.\u0275cmp=t.Xpm({type:e,selectors:[["sandbox-spheres","columns","","rows","","spread",""]],inputs:{columns:"columns",rows:"rows",spread:"spread"},features:[t._Bn([p.CN]),t.qOj],attrs:j,decls:2,vars:3,consts:[[4,"ngIf"],["castShadow","","receiveShadow","",3,"count","ref"],[3,"args"],[3,"attach","args"],["vertexColors",""]],template:function(n,s){1&n&&(t.YNc(0,W,5,9,"ng-container",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,s.viewModel$))},directives:[C.O5,V.f,L.o,R.a,E.l],pipes:[C.Ov],encapsulation:2,changeDetection:0}),e})();var b=o(5632),w=o(4446),q=o(5505),k=o(1556),_=o(5520),tt=o(6111),et=o(2088),nt=o(5959);const ot=function(e){return[0,e,10]},st=function(e){return{position:e}},it=function(){return[0,3,0]},rt=function(e,i){return[e,0,i]},at=function(e){return[e,0,0]};let Z=(()=>{class e{constructor(){this.scale=10,this.heights=function ct({width:e,height:i,number:n,scale:s}){const l=[],v=[];for(let r=0;r<n;r++)v.push([Math.random(),Math.random()]);let g=0;for(let r=0;r<e;r++){const c=[];for(let u=0;u<i;u++){let h=1/0;v.forEach(D=>{const I=(D[0]-r/e)**2+(D[1]-u/i)**2;I<h&&(h=I)});const B=Math.sqrt(h);B>g&&(g=B),c.push(B)}l.push(c)}for(let r=0;r<e;r++)for(let c=0;c<i;c++)l[r][c]*=s/g;return l}({height:128,number:10,scale:1,width:128})}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["sandbox-height-field-example"]],inputs:{scale:"scale"},decls:12,vars:25,consts:[["shadows","",3,"camera"],["attach","background","color","#171720"],["enableDamping","","dampingFactor","0.2",3,"minPolarAngle","maxPolarAngle"],["intensity","0.5"],["castShadow","",3,"position"],[3,"elementSize","heights","position","rotation"],["rows","3","columns","3",3,"spread"]],template:function(n,s){1&n&&(t.TgZ(0,"ngt-canvas",0),t._UZ(1,"ngt-color",1)(2,"ngt-soba-orbit-controls",2),t.ALo(3,"radian"),t.ALo(4,"radian"),t.TgZ(5,"ngt-physics"),t._UZ(6,"ngt-ambient-light",3)(7,"ngt-directional-light",4)(8,"sandbox-height-field",5),t.ALo(9,"radian"),t._UZ(10,"sandbox-spheres",6),t.qZA(),t._UZ(11,"ngt-stats"),t.qZA()),2&n&&(t.Q6J("camera",t.VKq(17,st,t.VKq(15,ot,-10))),t.xp6(2),t.Q6J("minPolarAngle",t.lcZ(3,9,60))("maxPolarAngle",t.lcZ(4,11,60)),t.xp6(5),t.Q6J("position",t.DdM(19,it)),t.xp6(1),t.Q6J("elementSize",s.scale/128)("heights",s.heights)("position",t.WLB(20,rt,-s.scale/2,s.scale/2))("rotation",t.VKq(23,at,t.lcZ(9,13,-90))),t.xp6(2),t.Q6J("spread",4))},directives:function(){return[b.B3,w.r,q.S,k.r,_.w,tt.Y,U,Y,et.Q]},pipes:function(){return[nt.j]},encapsulation:2,changeDetection:0}),e})(),lt=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[C.ez,O.Bz.forChild([{path:"",component:Z}]),f.x,S.II,a.M$,M.Bg,a.R,S.fV,m.$5,d.DX,m.bg,x.Li,d.kZ,p.M1,F.EQ,F.in]]}),e})()},5936:(z,y,o)=>{o.d(y,{I:()=>p.I});var p=o(8187)},8187:(z,y,o)=>{o.d(y,{I:()=>M,U:()=>F});var p=o(7017),d=o(6963),m=o(1858);const S=["*"];let F=(()=>{class a extends p.Jy{objectInitFn(){return new d.ZAu}}return a.\u0275fac=function(){let f;return function(C){return(f||(f=m.n5z(a)))(C||a)}}(),a.\u0275cmp=m.Xpm({type:a,selectors:[["ngt-group"]],features:[m._Bn([(0,p.Q2)(a)]),m.qOj],ngContentSelectors:S,decls:1,vars:0,template:function(x,C){1&x&&(m.F$t(),m.Hsn(0))},encapsulation:2,changeDetection:0}),a})(),M=(()=>{class a{}return a.\u0275fac=function(x){return new(x||a)},a.\u0275mod=m.oAB({type:a}),a.\u0275inj=m.cJS({}),a})()}}]);